<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="hr_timesheet_sheet_search_inherit" model="ir.ui.view">
            <field name="name">hr.timesheet.sheet.search.inherit</field>
            <field name="model">hr_timesheet_sheet.sheet</field>
            <field name="inherit_id" ref="hr_timesheet_sheet.view_hr_timesheet_sheet_filter"/>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//filter[@name='message_needaction']" position="after">
                        <filter name="with_warnings"
                                string="With Warnings"
                                domain="['|', ('no_break_warning', '=', True), ('working_hours_warning', '=', True)]"/>
                    </xpath>
                </data>
            </field>
        </record>


        <record id="hr_timesheet_sheet_form_inherit" model="ir.ui.view">
            <field name="name">hr.timesheet.sheet.form.inherit</field>
            <field name="model">hr_timesheet_sheet.sheet</field>
            <field name="inherit_id" ref="hr_timesheet_sheet.hr_timesheet_sheet_form"/>
            <field name="arch" type="xml">
                <data>

                    <xpath expr="//button[@name='button_confirm']" position="attributes">
                        <attribute name="confirm">This timesheet will be submitted to manager. Are you sure?</attribute>
                    </xpath>

                    <xpath expr="//button[@name='done']" position="attributes">
                        <attribute name="confirm">This timesheet will be confirmed. Are you sure?</attribute>
                    </xpath>

                    <xpath expr="//button[@name='action_set_to_draft']" position="attributes">
                        <attribute name="confirm">This timesheet will be sent to draft. Are you sure?</attribute>
                    </xpath>

                    <xpath expr="//button[@name='cancel']" position="attributes">
                        <attribute name="confirm">This timesheet will be refused. Are you sure?</attribute>
                    </xpath>


                    <xpath expr="//div[@class='oe_button_box']" position="replace"></xpath>



                    <xpath expr="//field[@name='total_attendance']/.." position="replace">
                        <group>
                            <field name="no_break_warning" invisible="1" />
                            <field name="working_hours_warning" invisible="1" />

                            <!--<h2 attrs="{'invisible': [('no_break_warning', '=', False)]}"-->
                                <!--class="text-danger">There are days with more than 8 hours of work without 30 minutes break.</h2>-->

                            <span attrs="{'invisible': [('no_break_warning', '=', False)]}"
                                  class="label label-danger">There are days with more than 8 hours of work without 30 minutes break.</span>

                            <!--<h2 attrs="{'invisible': [('working_hours_warning', '=', False)]}"-->
                                <!--class="text-danger">There are days with more than 10 hours of work.</h2>-->

                            <span attrs="{'invisible': [('working_hours_warning', '=', False)]}"
                                  class="label label-danger">There are days with more than 10 hours of work.</span>

                        </group>
                    </xpath>




                    <xpath expr="//widget[@type='weekly_timesheet']/.." position="replace">
                    </xpath>

                    <xpath expr="//field[@name='period_ids']/.." position="replace">
                    </xpath>


                    <xpath expr="//field[@name='timesheet_ids']/tree//field[@name='unit_amount']" position="replace">

                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/form//field[@name='unit_amount']" position="replace">

                    </xpath>


                    <xpath expr="//field[@name='timesheet_ids']/tree//field[@name='date']" position="after">
                        <field name="timesheet_department_id" options="{'no_open': True, 'no_create': True}" />
                        <field name="timesheet_start_time" widget="float_time" />
                        <field name="timesheet_end_time" widget="float_time" />
                        <field name="timesheet_break_amount" widget="float_time" />
                        <field name="unit_amount" widget="float_time" string="Hours" sum="Hours"/>
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/form//field[@name='date']" position="after">
                        <field name="timesheet_department_id" options="{'no_open': True, 'no_create': True}" />
                        <field name="timesheet_start_time" widget="float_time" />
                        <field name="timesheet_end_time" widget="float_time" />
                        <field name="timesheet_break_amount" widget="float_time" />
                        <field name="unit_amount" widget="float_time" string="Hours" sum="Hours"/>
                    </xpath>



                    <xpath expr="//field[@name='timesheet_ids']/tree//field[@name='name']" position="replace">
                        <field name="name" invisible="1" />
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/form//field[@name='name']" position="replace">
                        <field name="name" invisible="1" />
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/tree" position="attributes">
                        <attribute name="default_order">date, timesheet_start_time</attribute>
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/tree/field[@name='account_id']" position="after">
                        <field name="account_id_use_tasks" invisible="1" />
                        <field name="account_id_use_issues" invisible="1" />
                        <field name="timesheet_on_site_activity" invisible="1" />

                        <field name="project_activity_id"
                               attrs="{'required': [('account_id_use_tasks', '=', True),
                                                    ('account_id_use_issues', '=', True)]}"
                               options="{'no_open': True, 'no_create': True}" />
                        <field name="task_id"
                               attrs="{'required': [('account_id_use_tasks', '=', True),
                                                    ('account_id_use_issues', '=', True),
                                                    ('timesheet_on_site_activity', '=', True)]}"
                               options="{'no_open': True, 'no_create': True}"
                               domain="[('project_id.analytic_account_id', '=' , account_id)]" />


                        <field name="timesheet_travel_start" />
                        <field name="timesheet_travel_end" />
                        <!--<field name="timesheet_is_driver" />-->
                        <field name="timesheet_vehicle_id" options="{'no_open': True, 'no_create': True}" />
                        <field name="timesheet_accommodation" />
                        <field name="timesheet_comment" />
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/form//field[@name='account_id']" position="after">
                        <field name="account_id_use_tasks" invisible="1" />
                        <field name="account_id_use_issues" invisible="1" />
                        <field name="timesheet_on_site_activity" invisible="1" />

                        <field name="project_activity_id"
                               attrs="{'required': [('account_id_use_tasks', '=', True),
                                                    ('account_id_use_issues', '=', True)]}"
                               options="{'no_open': True, 'no_create': True}" />
                        <field name="task_id"
                               attrs="{'required': [('account_id_use_tasks', '=', True),
                                                    ('account_id_use_issues', '=', True),
                                                    ('timesheet_on_site_activity', '=', True)]}"
                               options="{'no_open': True, 'no_create': True}"
                               domain="[('project_id.analytic_account_id', '=' , account_id)]" />


                        <field name="timesheet_travel_start" />
                        <field name="timesheet_travel_end" />
                        <!--<field name="timesheet_is_driver" />-->
                        <field name="timesheet_vehicle_id" options="{'no_open': True, 'no_create': True}" />
                        <field name="timesheet_accommodation" />
                        <field name="timesheet_comment" />
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/tree/field[@name='account_id']" position="replace">
                        <field name="account_id" options="{'no_open': True, 'no_create': True}" string="Field of activity"/>
                    </xpath>

                    <xpath expr="//field[@name='timesheet_ids']/form//field[@name='account_id']" position="replace">
                        <field name="account_id" options="{'no_open': True, 'no_create': True}" string="Field of activity"/>
                    </xpath>




                </data>
            </field>
        </record>


        <record id="hr_timesheet_sheet_tree_simplified_inherit" model="ir.ui.view">
            <field name="name">hr.timesheet.sheet.tree.inherit</field>
            <field name="model">hr_timesheet_sheet.sheet</field>
            <field name="inherit_id" ref="hr_timesheet_sheet.hr_timesheet_sheet_tree_simplified"></field>
            <field name="arch" type="xml">
                <data>
                    <xpath expr="//field[@name='total_attendance']" position="replace"></xpath>
                    <xpath expr="//field[@name='total_difference']" position="replace"></xpath>

                    <xpath expr="//field[@name='state']" position="after">
                        <field name="no_break_warning" invisible="1" />
                        <field name="working_hours_warning" invisible="1" />
                    </xpath>

                    <xpath expr="//tree" position="attributes">
                        <attribute name="decoration-danger">no_break_warning or working_hours_warning</attribute>
                    </xpath>

                </data>
            </field>
        </record>


    </data>
</openerp>