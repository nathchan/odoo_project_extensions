<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record id="view_task_tree_inherit" model="ir.ui.view">
            <field name="name">project.task.tree.inherit</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_tree2"/>
            <field name="arch" type="xml">
                <data>

                    <xpath expr="//field[@name='stage_id']" position="after">
                        <field name="stage_progress" string="% Complete" widget="progressbar" />
                    </xpath>

                </data>
            </field>
        </record>

        <!-- Task form -->
        <record id="view_task_form_inherit" model="ir.ui.view">
            <field name="name">project.task.form.inherit</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_form2"/>
            <field name="arch" type="xml">
                <data>

                    <xpath expr="//field[@name='stage_id']" position="after">
                        <field name="has_processes" invisible="1" />
                        <field name="stage_process_id" domain="[('stage_id', '=', stage_id)]" attrs="{'invisible': [('has_processes', '!=', True)]}"  widget="statusbar" clickable="True" />
                    </xpath>

                    <xpath expr="//button[@name='toggle_active']" position="before">

                        <button name="return_action_to_open_milestones"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-line-chart"
                            help="show the milestones for this task">
                            <field name="milestone_count" widget="statinfo" string="Milestones"/>
                        </button>

                    </xpath>

                    <xpath expr="//field[@name='partner_id']" position="before">
                        <field name="subcontractor_id" />
                    </xpath>


                    <xpath expr="//page[@name='description_page']" position="after">
                        <page name="forecast_generation" string="Calculate">

                            <br />
                            <br />
                            <strong>Project: </strong><field class="oe_inline" name="forecast_project_id" />
                            <br />
                            <br />

                            <strong>Forecast start date: </strong><field class="oe_inline" name="forecast_start_date" />
                            <br />
                            <br />

                            <button name="action_fill_forecast_dates" type="object" string="Calculate FC" />
                            <br/>
                            <br/>
                        </page>

                    </xpath>


                    <xpath expr="//field[@name='tag_ids']" position="after">
                        <field name="work_package" />
                        <field name="stage_progress" string="% Complete" widget="progressbar" />
                    </xpath>




                </data>
            </field>
        </record>

    </data>
</openerp>